---
- name: Find modified files in /etc
  shell: >
    diff -qr /etc /.snapshots/alpha.1/localhost/etc | grep -E "Only in /etc|differ"
  register: diff_output
  ignore_errors: yes

- name: Print modified files
  debug:
    msg: "{{ diff_output.stdout_lines }}"

#- name: Restore modified files
#  shell: >
#    rsync -a --delete /.snapshots/alpha.1/localhost/etc/ /etc/
#  when: diff_output.stdout != ""
